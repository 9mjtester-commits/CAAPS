name: AAPS CI (manual branch build)

on:
  workflow_dispatch:
    inputs:
      targetBranch:
        description: 'Branch to build (e.g. main, dev, my-feature)'
        required: true
        default: 'main'
        type: string

      buildVariant:
        description: 'Select Build Variant'
        required: true
        default: 'fullRelease'
        type: choice
        options:
          - fullRelease
          - fullDebug
          - aapsclientRelease
          - aapsclientDebug
          - aapsclient2Release
          - aapsclient2Debug
          - pumpcontrolRelease
          - pumpcontrolDebug

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      # π”Ή ν•µμ‹¬ ν¬μΈνΈ
      - name: Checkout selected branch
        uses: actions/checkout@v4
        with:
          ref: ${{ github.event.inputs.targetBranch }}

      - name: Show branch
        run: |
          echo "Building branch:"
          git branch --show-current

      - name: Set BUILD_VARIANT
        run: |
          BUILD_VARIANT="${{ github.event.inputs.buildVariant }}"
          echo "BUILD_VARIANT=$BUILD_VARIANT" >> $GITHUB_ENV
